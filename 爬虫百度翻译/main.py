import time
import requests
import execjs
class Baidu_trans:
    """百度翻译爬虫脚本"""
    def __init__(self,*,input_message,from_language='zh',to_language='en'):
        self.input=input_message
        self.from_language=from_language
        self.to_language=to_language
        self.resp=None
        self.output=None

    def get_request(self):
        """做响应请求"""
        self.url = f'https://fanyi.baidu.com/v2transapi'
        with open('./1234.js','r') as f:
            content=f.read()
        ctx = execjs.compile(content)
        self.sign=ctx.call('b',f'{self.input}')
        self.tx=int(time.time()*1000)
        self.form_data = {"from": f"{self.from_language}",
                          "to": f"{self.to_language}",
                          "query": f"{self.input}",
                          "simple_means_flag": 3,
                          "sign": f"{self.sign}",
                          "token": "9a55d43931e765b77e40c51fd00def74",
                          "domain": "common",
                          "ts": self.tx}
        self.params = {
                    'from': f'{self.from_language}',
                    'to': f'{self.to_language}',
                    }

        self.headers={
                    'Accept': '*/*',
                    'Accept-Language': 'zh-CN,zh;q=0.9',
                    # 'Acs-Token': '1699794989421_1699794988498_eQ7V4EUz7vrF7FkouO4392SSVqRSQOFIpwlfJiaqddpIfIzpqH6Zz2VXgqDqGhJHC99ZgftxAPb3ildvgM2kanKgDTLzdZWMl6mMHm1iASmM6SGBGo2C4p4P7o4GlTEhUkHi6VJTqNHNvMxhBiGbXho80h8dh0sG5jGcQWSAVKKeDLLn9w+3SbPiKBy4+qpYk/Sv5gADLqeFghzzi8uBuDOOboiSIa7k6D8veQi5Xe1y2DVSo3OrSPOH7culdx5mYGAwwxV9X5Ue/gx5LVSZkyOm6KVGqwQK44by5w4uxGz1b/UX4hm236qxuPZUDuDz3NGLfEa6eGv5Um9UHwRn+98J9S2zui6+Z84Y6vCk9du8wggOx4b4BLFTvk34jmZ5HziwdqavVL3kPS/azYGHL/Mo8MFwgl4AfgyoTq3SCH0TgaLBiuApDFy8G6ZVvyYUDMXnDeJYTZniAVrD8zagCojP+Tf2/rAvIB5jHWlVilnbrYL9mhGREZglAE1HmQeaXSLJ3eHtza+CwfVA6REENQ==',
                    'Connection': 'keep-alive',
                    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
                    # 'Cookie': 'BIDUPSID=3A93B150EEB1A66FDFA98C82A313F6B7; PSTM=1679126014; BAIDUID=3A93B150EEB1A66F044C4DEE28974DD2:FG=1; BAIDUID_BFESS=3A93B150EEB1A66F044C4DEE28974DD2:FG=1; ZFY=HuLRX13Bkac7Whyy2NNQUXL90ZKXPlxzmYNspwNr7Yg:C; BA_HECTOR=ag2ka5850ha5ag240k200ka51il0tco1r; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; BDPASSGATE=IlPT2AEptyoA_yiU4SDt3lIN8eDEUsCD34OtVnti3ECGh67BmhH74dxlF6rpTW3sByyb-Yyfmq-dpjrFV6xjg0N_gRsZokJQlVejzdSCuMHtKxR88bIZCb4jKUE2sA8PchhX-4ETBQMyVygCceb6jvxvdfKl8PJNb4n076LBqKzYBl7pBWnEzGaTY6-7TZHeDciLxOPQgSdAIUGhZRD2LTPdnSFHNyQL70aOatY6I3XQtTk-B48wL4YhZHSC38V9BxOP3OyLxKSl2yU5q-2AT8QypSau90raNEdRAByBiadaQqj7Nq7rMTjuHqcmjbPhLLduSRasqbkEHjU76EMq0o2KFs0HEoXiPSQ5RNGGoB8tFoky6Vj6CBLi-psJKr4oWNhmTxxqO5hzmFaAreCupk0C0OSPw2dvM0wOCpePu8gwfn61Gorf8GOsm9Jd9X79X7afE5XiEaH8SIhKuACtB_zlQcfLCCUzmleloizSjSj91fj6RMRekIkf6m5JBZ7W5QePNo3XK3O_eLZfw245t2bUi-zjrIe-tZKLRNWpTxgDZnEcmqV4DGjOfYqmfpZVK4GdvI4n_VDDnCdMw0aEb5oPbPA01NJKOtD0JPITwc_IxZcyXCs1gq_oH31RVIDmxPxKAM0MKGjRBTf9X7lR5btu2jHtKGzWxd8J1S-HCk3X_5T2EN9ownRBi8hoKavgPknJg3Q0Nja0k4AsP2qIop6yFOEjEZBTj7fxG9TWOACB-4REqUEo8RgcCWj_WA4z8DRagRohO5Cn6Af2O_iggjE3upr8ce2WUam-Omvkc_; H_WISE_SIDS=213350_214806_110085_265881_234296_273244_273391_263619_274776_275005_276196_276454_276589_251972_271254_277621_275732_259642_278576_278388_256739_279020_277522_279075_276573_279385_279610_279744_269049_279876_279307_279013_279702_279998_280207_280449_280486_270366_278415_276929_275855_280765_280810_279845_280603_280106_278791_278953_280636_281038_280588_281191_281382_279203_275026_281393_281519_275167_267072_276665_280980_281723_277569_281730_281810_280169_281867_281897_281827_280650_275097_282063_274948_279749_282187_282191_282171_279913_281051_279009_281817_282486_282520_282572_282548_282604_282632_276924_282762_281832_280272_281973_282794_281180_269893_282232_272263_253022_282937_279419_282402_282996_283071_283039_236312_283156_188332_8000098_8000105_8000121_8000140_8000157_8000160_8000164_8000167_8000177_8000185_8000204; H_WISE_SIDS_BFESS=213350_214806_110085_265881_234296_273244_273391_263619_274776_275005_276196_276454_276589_251972_271254_277621_275732_259642_278576_278388_256739_279020_277522_279075_276573_279385_279610_279744_269049_279876_279307_279013_279702_279998_280207_280449_280486_270366_278415_276929_275855_280765_280810_279845_280603_280106_278791_278953_280636_281038_280588_281191_281382_279203_275026_281393_281519_275167_267072_276665_280980_281723_277569_281730_281810_280169_281867_281897_281827_280650_275097_282063_274948_279749_282187_282191_282171_279913_281051_279009_281817_282486_282520_282572_282548_282604_282632_276924_282762_281832_280272_281973_282794_281180_269893_282232_272263_253022_282937_279419_282402_282996_283071_283039_236312_283156_188332_8000098_8000105_8000121_8000140_8000157_8000160_8000164_8000167_8000177_8000185_8000204; APPGUIDE_10_6_7=1; REALTIME_TRANS_SWITCH=1; FANYI_WORD_SWITCH=1; HISTORY_SWITCH=1; SOUND_SPD_SWITCH=1; SOUND_PREFER_SWITCH=1; Hm_lvt_64ecd82404c51e03dc91cb9e8c025574=1699774279,1699788994,1699789941; BDUSS=gwVy1FQmlJODNzOVJIcmFKSGlSY1lKUERMeTNOMktpemVGdmtpZzZrNXFWSGhsRVFBQUFBJCQAAAAAAAAAAAEAAABih-SgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrHUGVqx1BlQl; BDUSS_BFESS=gwVy1FQmlJODNzOVJIcmFKSGlSY1lKUERMeTNOMktpemVGdmtpZzZrNXFWSGhsRVFBQUFBJCQAAAAAAAAAAAEAAABih-SgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrHUGVqx1BlQl; ab_sr=1.0.1_MWQ3NWQ1M2NmNTdkOGM5Njg3YTNlNGViNWE0N2RkMjZlM2IyOGI4MDViMGI0NDNiOTVmMDM0MWZhZmMxOTE4NjE5YTdhNzFhZjc0ODkyOTU2NDQxMWE1Njc3YmI5MjBmZjE1NjEwNWQ0OTdmY2I1YTQwMTk0YmUxMzcxMjllNmE3YTY4YTRkZDRhMzY3OTIzODFiYzg3OWU2ODM1NzQxM2QzOWNkMDQwN2QwYzA2YzYwNjIwYWExY2M1YzM0ZmM2; Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574=1699794986',
                    'Origin': 'https://fanyi.baidu.com',
                    'Referer': 'https://fanyi.baidu.com/',
                    'Sec-Fetch-Dest': 'empty',
                    'Sec-Fetch-Mode': 'cors',
                    'Sec-Fetch-Site': 'same-origin',
                    'User-Agent': 'UA请自行设置',
                    'X-Requested-With': 'XMLHttpRequest',
                    'sec-ch-ua': '"Google Chrome";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',
                    'sec-ch-ua-mobile': '?0',
                    'sec-ch-ua-platform': '"macOS"',
                }


        self.cookies={
                    'BIDUPSID': '3A93B150EEB1A66FDFA98C82A313F6B7',
                    'PSTM': '1679126014',
                    'BAIDUID': '3A93B150EEB1A66F044C4DEE28974DD2:FG=1',
                    'BAIDUID_BFESS': '3A93B150EEB1A66F044C4DEE28974DD2:FG=1',
                    'ZFY': 'HuLRX13Bkac7Whyy2NNQUXL90ZKXPlxzmYNspwNr7Yg:C',
                    'BA_HECTOR': 'ag2ka5850ha5ag240k200ka51il0tco1r',
                    'BDORZ': 'B490B5EBF6F3CD402E515D22BCDA1598',
                    'BDPASSGATE': 'IlPT2AEptyoA_yiU4SDt3lIN8eDEUsCD34OtVnti3ECGh67BmhH74dxlF6rpTW3sByyb-Yyfmq-dpjrFV6xjg0N_gRsZokJQlVejzdSCuMHtKxR88bIZCb4jKUE2sA8PchhX-4ETBQMyVygCceb6jvxvdfKl8PJNb4n076LBqKzYBl7pBWnEzGaTY6-7TZHeDciLxOPQgSdAIUGhZRD2LTPdnSFHNyQL70aOatY6I3XQtTk-B48wL4YhZHSC38V9BxOP3OyLxKSl2yU5q-2AT8QypSau90raNEdRAByBiadaQqj7Nq7rMTjuHqcmjbPhLLduSRasqbkEHjU76EMq0o2KFs0HEoXiPSQ5RNGGoB8tFoky6Vj6CBLi-psJKr4oWNhmTxxqO5hzmFaAreCupk0C0OSPw2dvM0wOCpePu8gwfn61Gorf8GOsm9Jd9X79X7afE5XiEaH8SIhKuACtB_zlQcfLCCUzmleloizSjSj91fj6RMRekIkf6m5JBZ7W5QePNo3XK3O_eLZfw245t2bUi-zjrIe-tZKLRNWpTxgDZnEcmqV4DGjOfYqmfpZVK4GdvI4n_VDDnCdMw0aEb5oPbPA01NJKOtD0JPITwc_IxZcyXCs1gq_oH31RVIDmxPxKAM0MKGjRBTf9X7lR5btu2jHtKGzWxd8J1S-HCk3X_5T2EN9ownRBi8hoKavgPknJg3Q0Nja0k4AsP2qIop6yFOEjEZBTj7fxG9TWOACB-4REqUEo8RgcCWj_WA4z8DRagRohO5Cn6Af2O_iggjE3upr8ce2WUam-Omvkc_',
                    'H_WISE_SIDS': '213350_214806_110085_265881_234296_273244_273391_263619_274776_275005_276196_276454_276589_251972_271254_277621_275732_259642_278576_278388_256739_279020_277522_279075_276573_279385_279610_279744_269049_279876_279307_279013_279702_279998_280207_280449_280486_270366_278415_276929_275855_280765_280810_279845_280603_280106_278791_278953_280636_281038_280588_281191_281382_279203_275026_281393_281519_275167_267072_276665_280980_281723_277569_281730_281810_280169_281867_281897_281827_280650_275097_282063_274948_279749_282187_282191_282171_279913_281051_279009_281817_282486_282520_282572_282548_282604_282632_276924_282762_281832_280272_281973_282794_281180_269893_282232_272263_253022_282937_279419_282402_282996_283071_283039_236312_283156_188332_8000098_8000105_8000121_8000140_8000157_8000160_8000164_8000167_8000177_8000185_8000204',
                    'H_WISE_SIDS_BFESS': '213350_214806_110085_265881_234296_273244_273391_263619_274776_275005_276196_276454_276589_251972_271254_277621_275732_259642_278576_278388_256739_279020_277522_279075_276573_279385_279610_279744_269049_279876_279307_279013_279702_279998_280207_280449_280486_270366_278415_276929_275855_280765_280810_279845_280603_280106_278791_278953_280636_281038_280588_281191_281382_279203_275026_281393_281519_275167_267072_276665_280980_281723_277569_281730_281810_280169_281867_281897_281827_280650_275097_282063_274948_279749_282187_282191_282171_279913_281051_279009_281817_282486_282520_282572_282548_282604_282632_276924_282762_281832_280272_281973_282794_281180_269893_282232_272263_253022_282937_279419_282402_282996_283071_283039_236312_283156_188332_8000098_8000105_8000121_8000140_8000157_8000160_8000164_8000167_8000177_8000185_8000204',
                    'APPGUIDE_10_6_7': '1',
                    'REALTIME_TRANS_SWITCH': '1',
                    'FANYI_WORD_SWITCH': '1',
                    'HISTORY_SWITCH': '1',
                    'SOUND_SPD_SWITCH': '1',
                    'SOUND_PREFER_SWITCH': '1',
                    'Hm_lvt_64ecd82404c51e03dc91cb9e8c025574': '1699774279,1699788994,1699789941',
                    'BDUSS': 'gwVy1FQmlJODNzOVJIcmFKSGlSY1lKUERMeTNOMktpemVGdmtpZzZrNXFWSGhsRVFBQUFBJCQAAAAAAAAAAAEAAABih-SgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrHUGVqx1BlQl',
                    'BDUSS_BFESS': 'gwVy1FQmlJODNzOVJIcmFKSGlSY1lKUERMeTNOMktpemVGdmtpZzZrNXFWSGhsRVFBQUFBJCQAAAAAAAAAAAEAAABih-SgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGrHUGVqx1BlQl',
                    'ab_sr': '1.0.1_MWQ3NWQ1M2NmNTdkOGM5Njg3YTNlNGViNWE0N2RkMjZlM2IyOGI4MDViMGI0NDNiOTVmMDM0MWZhZmMxOTE4NjE5YTdhNzFhZjc0ODkyOTU2NDQxMWE1Njc3YmI5MjBmZjE1NjEwNWQ0OTdmY2I1YTQwMTk0YmUxMzcxMjllNmE3YTY4YTRkZDRhMzY3OTIzODFiYzg3OWU2ODM1NzQxM2QzOWNkMDQwN2QwYzA2YzYwNjIwYWExY2M1YzM0ZmM2',
                    'Hm_lpvt_64ecd82404c51e03dc91cb9e8c025574': '1699794986',}


        self.resp=requests.post(url=self.url,params=self.params,headers=self.headers,cookies=self.cookies,data=self.form_data).json()
        return self.resp
    def response_xpath(self):
        """解析相映"""
        if self.resp!=None:
            self.output=self.resp['trans_result']['data'][0]['dst']
            print(f"翻译前为：{self.input}，翻译后为：{self.output}")

            return self.output
        else:
            print("未执行请求操作")

if __name__ == '__main__':
    """做测试"""
    ss=Baidu_trans(input_message='I want to play',from_language='en',to_language='zh')
    ss.get_request()
    ss.response_xpath()